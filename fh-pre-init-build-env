#!/bin/bash

show_usage()
{
  cat << EOF

Usage: $(basename $0) <machine>

EOF
}

main()
{
  if [ $# -lt 1 ]; then
    show_usage
    exit 1
  fi
  local MACHINE="$1"

  export TEMPLATECONF="$YOCTO_LAYERS_DIR/meta-fotahub/conf"

  # Remove broken/orphaned Yocto build configuration file sym-links, if any
  if [ ! -f "$YOCTO_COCKPIT_DIR/conf/bblayers.conf" ] && [ -h "$YOCTO_BUILD_DIR/conf/bblayers.conf" ]; then
    rm "$YOCTO_BUILD_DIR/conf/bblayers.conf"
  fi
  if [ ! -f "$YOCTO_COCKPIT_DIR/conf/local.conf" ] && [ -h "$YOCTO_BUILD_DIR/conf/local.conf" ]; then
    rm "$YOCTO_BUILD_DIR/conf/local.conf"
  fi
}

main $@